# 策略模块说明文档

## 概述

本策略模块基于 vn.py 框架实现，包含多种量化交易策略，适用于不同的市场环境和交易风格。

## 策略列表

### 1. 海龟交易策略 (TurtleStrategy)

**文件位置**: [turtle_trading_strategy.py](file:///d:/深度学习/代码/量化/quant-vnpy/internal/strategies/turtle_trading_strategy.py)

#### 策略简介
海龟交易策略是经典的趋势跟踪策略，由理查德·丹尼斯在1980年代推广。该策略基于价格突破和风险控制，适用于趋势明显的市场。

#### 策略参数

| 参数 | 类型 | 默认值 | 说明 |
|------|------|--------|------|
| entry_window | int | 20 | 突破入场窗口（天数） |
| exit_window | int | 10 | 突破出场窗口（天数） |
| atr_window | int | 20 | ATR计算窗口 |
| risk_ratio | float | 0.01 | 每单位风险占资金比例（1%） |
| max_add | int | 4 | 最大加仓次数 |
| add_gap | float | 0.5 | 加仓间隔（ATR倍数） |

#### 策略变量

| 变量 | 类型 | 说明 |
|------|------|------|
| day_high | float | 入场窗口最高价 |
| day_low | float | 出场窗口最低价 |
| atr_value | float | 当前ATR值 |
| unit_size | int | 每单位交易手数 |
| last_entry_price | float | 最后一次入场价 |
| add_count | int | 已加仓次数 |
| intra_trade_high | float | 持仓期间最高价 |
| intra_trade_low | float | 持仓期间最低价 |

#### 策略逻辑

**入场条件**:
- 当收盘价突破过去20天最高价时，开多仓

**加仓条件**:
- 持有多头时，价格达到上次入场价 + 0.5倍ATR时加仓
- 最多加仓4次

**出场条件**:
- 价格跌破持仓期间最高价 - 2倍ATR时止损
- 价格跌破过去10天最低价时出场

**仓位管理**:
- 单位手数 = (资金 × 风险比例) / (ATR × 合约乘数)

#### 适用场景
- 趋势明显的市场
- 波动性适中的品种
- 适合中长期交易

#### 风险提示
- 震荡市场容易频繁止损
- 加仓机制会增加风险敞口
- 需要充足的资金支持

---

### 2. 牛市策略 (BullStrategy)

**文件位置**: [bull_trend_strategy.py](file:///d:/深度学习/代码/量化/quant-vnpy/internal/strategies/bull_trend_strategy.py)

#### 策略简介
牛市策略基于均线交叉信号，在趋势向上时逢低做多，适合牛市行情。

#### 策略参数

| 参数 | 类型 | 默认值 | 说明 |
|------|------|--------|------|
| fast_window | int | 10 | 快速均线周期 |
| slow_window | int | 30 | 慢速均线周期 |
| fixed_size | int | 1 | 固定交易手数 |

#### 策略变量

| 变量 | 类型 | 说明 |
|------|------|------|
| fast_ma0 | float | 当前快速均线值 |
| fast_ma1 | float | 上一根快速均线值 |
| slow_ma0 | float | 当前慢速均线值 |
| slow_ma1 | float | 上一根慢速均线值 |

#### 策略逻辑

**入场条件**:
- 快速均线向上穿越慢速均线（金叉）时开多仓

**出场条件**:
- 价格跌破快速均线时平仓

**特殊情况**:
- 持有空头时出现金叉，先平空再开多

#### 适用场景
- 明显的上涨趋势
- 波动性适中的市场
- 适合中短期交易

#### 风险提示
- 震荡市场容易产生假信号
- 单边持仓可能错过反转机会

---

### 3. 熊市策略 (BearStrategy)

**文件位置**: [bull_trend_strategy.py](file:///d:/深度学习/代码/量化/quant-vnpy/internal/strategies/bull_trend_strategy.py)

#### 策略简介
熊市策略结合均线交叉和RSI指标，在趋势向下时逢高做空，适合熊市行情。

#### 策略参数

| 参数 | 类型 | 默认值 | 说明 |
|------|------|--------|------|
| fast_window | int | 10 | 快速均线周期 |
| slow_window | int | 30 | 慢速均线周期 |
| rsi_window | int | 14 | RSI计算窗口 |
| rsi_overbought | int | 70 | RSI超买阈值 |
| fixed_size | int | 1 | 固定交易手数 |

#### 策略变量

| 变量 | 类型 | 说明 |
|------|------|------|
| fast_ma0 | float | 当前快速均线值 |
| fast_ma1 | float | 上一根快速均线值 |
| slow_ma0 | float | 当前慢速均线值 |
| slow_ma1 | float | 上一根慢速均线值 |
| rsi_value | float | 当前RSI值 |

#### 策略逻辑

**入场条件**:
- 快速均线向下穿越慢速均线（死叉）时开空仓

**加仓条件**:
- 价格反弹至快速均线附近且RSI超买时加仓空单

**出场条件**:
- 价格跌破慢速均线95%时止盈

#### 适用场景
- 明显的下跌趋势
- 反弹做空机会
- 适合中短期交易

#### 风险提示
- 反弹可能演变为反转
- RSI指标可能失效
- 需要严格止损

---

### 4. 均值回归策略 (MeanReversionStrategy)

**文件位置**: [mean_reversion_strategy.py](file:///d:/深度学习/代码/量化/quant-vnpy/internal/strategies/mean_reversion_strategy.py)

#### 策略简介
均值回归策略基于统计学原理，认为价格会围绕均值波动，当价格偏离均值过多时会回归。适合震荡市场。

#### 策略参数

| 参数 | 类型 | 默认值 | 说明 |
|------|------|--------|------|
| window_size | int | 20 | 计算均值和标准差的窗口 |
| std_dev_multiplier | float | 2.0 | 标准差倍数 |
| fixed_size | int | 1 | 每次交易手数 |

#### 策略变量

| 变量 | 类型 | 说明 |
|------|------|------|
| mean | float | 均值 |
| std | float | 标准差 |
| upper_band | float | 上轨（均值 + K倍标准差） |
| lower_band | float | 下轨（均值 - K倍标准差） |

#### 策略逻辑

**开多条件**:
- 价格低于下轨（均值 - 2倍标准差）时开多仓

**开空条件**:
- 价格高于上轨（均值 + 2倍标准差）时开空仓

**平仓条件**:
- 持有多头时，价格回归均值时平仓
- 持有空头时，价格回归均值时平仓

#### 适用场景
- 震荡市场
- 价格波动有规律
- 适合短期交易

#### 风险提示
- 趋势市场容易亏损
- 极端行情可能突破通道
- 需要及时止损

---

## 使用指南

### 环境要求

- Python >= 3.10
- vnpy >= 4.3.0
- 相关依赖包已安装

### 基本使用步骤

1. **选择策略**
   - 根据市场环境选择合适的策略
   - 牛市：使用BullStrategy
   - 熊市：使用BearStrategy
   - 震荡：使用MeanReversionStrategy
   - 趋势：使用TurtleStrategy

2. **参数配置**
   - 根据品种特性调整参数
   - 建议先在模拟环境测试
   - 记录参数优化结果

3. **风险控制**
   - 设置合理的止损
   - 控制仓位大小
   - 监控策略表现

### 策略对比

| 策略 | 市场环境 | 风险等级 | 交易频率 | 复杂度 |
|------|----------|----------|----------|--------|
| 海龟交易 | 趋势 | 中 | 低 | 高 |
| 牛市策略 | 上涨 | 低 | 中 | 低 |
| 熊市策略 | 下跌 | 中 | 中 | 中 |
| 均值回归 | 震荡 | 低 | 高 | 低 |

### 注意事项

1. **回测验证**
   - 所有策略必须经过充分回测
   - 考虑交易成本和滑点
   - 验证策略稳定性

2. **实盘谨慎**
   - 从小仓位开始
   - 持续监控策略表现
   - 及时调整参数

3. **风险管理**
   - 严格执行止损
   - 控制最大回撤
   - 分散投资品种

4. **持续优化**
   - 定期评估策略表现
   - 根据市场变化调整
   - 保持学习态度

---

## 技术支持

如有问题或建议，请联系开发团队或查看vn.py官方文档。

## 免责声明

本策略模块仅供学习和研究使用，不构成投资建议。量化交易存在风险，请谨慎操作，盈亏自负。
